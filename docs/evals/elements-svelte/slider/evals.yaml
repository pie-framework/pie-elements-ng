version: 1

component:
  element: "@pie-elements-ng/slider"
  framework: "svelte"

examplesApp:
  app: "@pie-demos/sveltekit"
  routeTemplate: "/demos/<tagName>"

evals:
  # ==========================================================================
  # Basic Rendering
  # ==========================================================================
  - id: "slider-svelte/default/renders-gather"
    sampleId: "default"
    severity: "error"

    intent: "Validates slider renders correctly in gather mode with all UI elements"

    notes:
      - "Should display prompt, slider input, value display, and bound labels"
      - "Slider should be interactive and enabled"
      - "Initial value defaults to lowerBound"

    steps:
      - action: navigate
        path: "/slider"

      - action: observe
        target:
          description: "Prompt text"
          hint: 'text="What percentage of Earth\'s surface is covered by water?"'
        expected:
          exists: true

      - action: observe
        target:
          description: "Slider input"
          hint: 'input[type="range"]'
        expected:
          exists: true

      - action: observe
        target:
          description: "Value display"
          hint: '.value-display'
        expected:
          exists: true

      - action: axe
        expected:
          maxViolations: 0
          wcagLevel: "AA"

    spiritChecks:
      - "Prompt displays clearly and is easy to read"
      - "Slider thumb is visible and easy to grab"
      - "Value display updates as slider moves"
      - "Bound labels show min/max values"

  # ==========================================================================
  # User Interactions - Correct Answer
  # ==========================================================================
  - id: "slider-svelte/default/correct-answer"
    sampleId: "default"
    severity: "error"

    intent: "Validates correct answer selection yields score of 1.0"

    notes:
      - "Correct answer is 71"
      - "Should update session state when slider moves"
      - "Evaluate mode should show 'Correct!' feedback"

    steps:
      - action: navigate
        path: "/slider"

      - action: type
        target:
          description: "Slider input set to 71"
          hint: 'input[type="range"]'
        text: "71"

      - action: observe
        target:
          description: "Value display shows 71"
          hint: '.value-display'
        expected:
          contains: "71"

      - action: click
        target:
          description: "Evaluate mode radio"
          hint: 'input[name="mode"][value="evaluate"]'

      - action: wait
        timeout: 1000

      - action: observe
        target:
          description: "Correct feedback indicator"
          hint: '.response-indicator.correct'
        expected:
          exists: true

      - action: observe
        target:
          description: "Correct status text"
          hint: 'text="Correct!"'
        expected:
          exists: true

  # ==========================================================================
  # User Interactions - Incorrect Answer
  # ==========================================================================
  - id: "slider-svelte/default/incorrect-answer"
    sampleId: "default"
    severity: "error"

    intent: "Validates incorrect answer yields score of 0.0"

    notes:
      - "Select value far from correct answer (71)"
      - "Should show 'Incorrect' and difference"

    steps:
      - action: navigate
        path: "/slider"

      - action: type
        target:
          description: "Slider input set to 30"
          hint: 'input[type="range"]'
        text: "30"

      - action: click
        target:
          description: "Evaluate mode"
          hint: 'input[name="mode"][value="evaluate"]'

      - action: wait
        timeout: 1000

      - action: observe
        target:
          description: "Incorrect feedback indicator"
          hint: '.response-indicator.incorrect'
        expected:
          exists: true

      - action: observe
        target:
          description: "Incorrect status text"
          hint: 'text="Incorrect"'
        expected:
          exists: true

  # ==========================================================================
  # User Interactions - Partial Credit
  # ==========================================================================
  - id: "slider-svelte/default/partial-credit"
    sampleId: "default"
    severity: "error"

    intent: "Validates partial credit scoring with tolerance"

    notes:
      - "Sample has partialScoring: true, scoringTolerance: 10"
      - "Correct answer is 71"
      - "Answer of 65 should give partial credit (difference = 6)"
      - "Credit = 1 - (6/10) = 0.4 (40%)"

    steps:
      - action: navigate
        path: "/slider"

      - action: type
        target:
          description: "Slider input set to 65"
          hint: 'input[type="range"]'
        text: "65"

      - action: click
        target:
          description: "Evaluate mode"
          hint: 'input[name="mode"][value="evaluate"]'

      - action: wait
        timeout: 1000

      - action: observe
        target:
          description: "Partial credit indicator"
          hint: '.response-indicator.partial'
        expected:
          exists: true

      - action: observe
        target:
          description: "Partial credit status"
          hint: 'text="Partially correct"'
        expected:
          exists: true

  # ==========================================================================
  # Modes - View Mode
  # ==========================================================================
  - id: "slider-svelte/default/view-mode"
    sampleId: "default"
    severity: "error"

    intent: "Validates view mode displays answer without allowing changes"

    notes:
      - "Should show selected value"
      - "Slider should be disabled"
      - "No evaluation feedback shown"

    steps:
      - action: navigate
        path: "/slider"

      - action: type
        target:
          description: "Select value 50"
          hint: 'input[type="range"]'
        text: "50"

      - action: click
        target:
          description: "View mode"
          hint: 'input[name="mode"][value="view"]'

      - action: wait
        timeout: 1000

      - action: observe
        target:
          description: "Slider is disabled"
          hint: 'input[type="range"][disabled]'
        expected:
          exists: true

      - action: observe
        target:
          description: "Value still shows 50"
          hint: '.value-display'
        expected:
          contains: "50"

  # ==========================================================================
  # Modes - Instructor Rationale
  # ==========================================================================
  - id: "slider-svelte/default/instructor-rationale"
    sampleId: "default"
    severity: "error"

    intent: "Validates instructor role displays rationale in evaluate mode"

    notes:
      - "Sample has rationaleEnabled: true"
      - "Rationale should only show for instructor role"
      - "Should show correct answer to instructor"

    steps:
      - action: navigate
        path: "/slider"

      - action: type
        target:
          description: "Select any value"
          hint: 'input[type="range"]'
        text: "50"

      - action: click
        target:
          description: "Evaluate mode"
          hint: 'input[name="mode"][value="evaluate"]'

      - action: click
        target:
          description: "Instructor role"
          hint: 'input[name="role"][value="instructor"]'

      - action: wait
        timeout: 1000

      - action: observe
        target:
          description: "Rationale section visible"
          hint: '.rationale'
        expected:
          exists: true

      - action: observe
        target:
          description: "Correct answer displayed"
          hint: '.correct-answer'
        expected:
          exists: true

  # ==========================================================================
  # Configuration - Vertical Orientation
  # ==========================================================================
  - id: "slider-svelte/vertical-orientation/renders"
    sampleId: "vertical-orientation"
    severity: "error"

    intent: "Validates vertical orientation configuration applies correctly"

    notes:
      - "Sample uses orientation: 'vertical'"
      - "Should render vertically with appropriate styling"

    steps:
      - action: navigate
        path: "/slider"
        params:
          sampleId: "vertical-orientation"

      - action: observe
        target:
          description: "Vertical slider container"
          hint: '.pie-slider.vertical'
        expected:
          exists: true

      - action: observe
        target:
          description: "Slider input exists"
          hint: 'input[type="range"]'
        expected:
          exists: true

      - action: axe
        expected:
          maxViolations: 0
          wcagLevel: "AA"

  # ==========================================================================
  # Configuration - Simple Range
  # ==========================================================================
  - id: "slider-svelte/simple-range/basic-interaction"
    sampleId: "simple-range"
    severity: "error"

    intent: "Validates simple range configuration without scoring"

    notes:
      - "Simplified sample without correctResponse"
      - "Should still allow interaction and session updates"

    steps:
      - action: navigate
        path: "/slider"
        params:
          sampleId: "simple-range"

      - action: observe
        target:
          description: "Slider renders"
          hint: 'input[type="range"]'
        expected:
          exists: true

      - action: type
        target:
          description: "Set slider value"
          hint: 'input[type="range"]'
        text: "5"

      - action: observe
        target:
          description: "Value display updates"
          hint: '.value-display'
        expected:
          contains: "5"

  # ==========================================================================
  # Accessibility - Keyboard Navigation
  # ==========================================================================
  - id: "slider-svelte/default/keyboard-navigation"
    sampleId: "default"
    severity: "error"

    intent: "Validates full keyboard navigation support"

    notes:
      - "Must be navigable with Tab key"
      - "Arrow keys should adjust slider value"
      - "Focus indicators must be visible"

    steps:
      - action: navigate
        path: "/slider"

      - action: observe
        target:
          description: "Slider input is focusable"
          hint: 'input[type="range"]'
        expected:
          exists: true

      - action: axe
        expected:
          maxViolations: 0
          wcagLevel: "AA"

    spiritChecks:
      - "Tab key focuses the slider"
      - "Arrow keys adjust the value smoothly"
      - "Focus indicator is clearly visible"
      - "No keyboard traps"

  # ==========================================================================
  # Accessibility - ARIA Attributes
  # ==========================================================================
  - id: "slider-svelte/default/aria-attributes"
    sampleId: "default"
    severity: "error"

    intent: "Validates proper ARIA attributes for accessibility"

    notes:
      - "Slider should have aria-valuemin, aria-valuemax, aria-valuenow"
      - "Value display should have aria-live for announcements"
      - "Prompt should be associated via aria-labelledby"

    steps:
      - action: navigate
        path: "/slider"

      - action: observe
        target:
          description: "Slider with ARIA attributes"
          hint: 'input[type="range"][aria-valuemin][aria-valuemax]'
        expected:
          exists: true

      - action: observe
        target:
          description: "Value display with live region"
          hint: '.value-display[aria-live="polite"]'
        expected:
          exists: true

    spiritChecks:
      - "Screen readers announce current value"
      - "Min/max bounds are communicated"
      - "Value changes are announced dynamically"

  # ==========================================================================
  # Accessibility - Touch Target Size
  # ==========================================================================
  - id: "slider-svelte/default/touch-targets"
    sampleId: "default"
    severity: "error"

    intent: "Validates touch targets meet WCAG 2.2 requirements (44x44px)"

    notes:
      - "Slider track and thumb must be at least 24px height"
      - "WCAG 2.2 Level AA Target Size criterion"

    steps:
      - action: navigate
        path: "/slider"

      - action: checkStyle
        target:
          description: "Slider track"
          hint: '.slider-track'
        property: "height"
        expected:
          greaterThanOrEqual: 24

    spiritChecks:
      - "Slider is easy to grab on mobile devices"
      - "Thumb size feels appropriate for touch interaction"

  # ==========================================================================
  # Error Handling - Empty Submission
  # ==========================================================================
  - id: "slider-svelte/default/empty-submission"
    sampleId: "default"
    severity: "error"

    intent: "Validates graceful handling when slider not moved from default"

    notes:
      - "Default value is lowerBound (0)"
      - "Should handle evaluation without explicit interaction"
      - "No JavaScript errors"

    steps:
      - action: navigate
        path: "/slider"

      - action: click
        target:
          description: "Evaluate mode without moving slider"
          hint: 'input[name="mode"][value="evaluate"]'

      - action: wait
        timeout: 1000

      - action: observe
        target:
          description: "Element renders without error"
          hint: '.pie-slider'
        expected:
          exists: true

  # ==========================================================================
  # State Management - Mode Switching
  # ==========================================================================
  - id: "slider-svelte/default/mode-switching"
    sampleId: "default"
    severity: "error"

    intent: "Validates smooth transitions between modes"

    notes:
      - "Should switch between gather, view, evaluate modes"
      - "Session state should persist"
      - "No visual glitches or errors"

    steps:
      - action: navigate
        path: "/slider"

      - action: type
        target:
          description: "Set value"
          hint: 'input[type="range"]'
        text: "75"

      - action: click
        target:
          description: "View mode"
          hint: 'input[name="mode"][value="view"]'

      - action: wait
        timeout: 500

      - action: observe
        target:
          description: "Value persists"
          hint: '.value-display'
        expected:
          contains: "75"

      - action: click
        target:
          description: "Evaluate mode"
          hint: 'input[name="mode"][value="evaluate"]'

      - action: wait
        timeout: 500

      - action: click
        target:
          description: "Back to gather"
          hint: 'input[name="mode"][value="gather"]'

      - action: wait
        timeout: 500

      - action: observe
        target:
          description: "Element stable"
          hint: '.pie-slider'
        expected:
          exists: true

  # ==========================================================================
  # State Management - Reset Functionality
  # ==========================================================================
  - id: "slider-svelte/default/reset"
    sampleId: "default"
    severity: "error"

    intent: "Validates reset button clears session and returns to initial state"

    steps:
      - action: navigate
        path: "/slider"

      - action: type
        target:
          description: "Set value"
          hint: 'input[type="range"]'
        text: "80"

      - action: click
        target:
          description: "Reset button"
          hint: 'button:has-text("Reset")'

      - action: wait
        timeout: 500

      - action: observe
        target:
          description: "Value reset to lowerBound (0)"
          hint: '.value-display'
        expected:
          contains: "0"

  # ==========================================================================
  # Performance - Initial Load
  # ==========================================================================
  - id: "slider-svelte/default/load-performance"
    sampleId: "default"
    severity: "warn"

    intent: "Validates element loads and renders within acceptable time"

    notes:
      - "Target: < 2s to interactive"
      - "Measured from navigation to visible element"

    steps:
      - action: navigate
        path: "/slider"

      - action: wait
        condition: "networkidle"

      - action: observe
        target:
          description: "Element rendered"
          hint: '.pie-slider'
        expected:
          exists: true

  # ==========================================================================
  # Style & Visual - Color Contrast
  # ==========================================================================
  - id: "slider-svelte/default/style-color-contrast"
    sampleId: "default"
    severity: "error"

    intent: "Validates text color contrast meets WCAG 2.2 Level AA standards"

    notes:
      - "WCAG 2.2 AA: Normal text requires 4.5:1 contrast ratio"
      - "Critical for users with visual impairments"

    steps:
      - action: navigate
        path: "/slider"

      - action: checkColorContrast
        target:
          description: "Prompt text"
          hint: 'text="What percentage of Earth\'s surface is covered by water?"'
        expected:
          ratio:
            greaterThanOrEqual: 4.5

      - action: checkColorContrast
        target:
          description: "Value display text"
          hint: '.value-number'
        expected:
          ratio:
            greaterThanOrEqual: 4.5

    spiritChecks:
      - "Text is easily readable on all backgrounds"
      - "Slider thumb has sufficient contrast with track"

  # ==========================================================================
  # Style & Visual - Typography
  # ==========================================================================
  - id: "slider-svelte/default/style-typography"
    sampleId: "default"
    severity: "warn"

    intent: "Validates typography meets readability best practices"

    notes:
      - "Font size should be at least 14px for body text"
      - "Line height should be at least 1.2 for readability"

    steps:
      - action: navigate
        path: "/slider"

      - action: checkFont
        target:
          description: "Prompt text"
          hint: '.prompt'
        expected:
          fontSize:
            greaterThanOrEqual: 14
          lineHeight:
            greaterThanOrEqual: 1.2

    spiritChecks:
      - "Text is comfortable to read"
      - "Value display is prominent and clear"

  # ==========================================================================
  # Style & Visual - Layout Responsiveness
  # ==========================================================================
  - id: "slider-svelte/default/style-layout"
    sampleId: "default"
    severity: "warn"

    intent: "Validates element layout is responsive and well-structured"

    notes:
      - "Element should have reasonable min/max widths"
      - "Spacing should be consistent"

    steps:
      - action: navigate
        path: "/slider"

      - action: checkLayout
        target:
          description: "Slider container"
          hint: '.pie-slider'
        expected:
          boundingBox:
            minWidth: 200

    spiritChecks:
      - "Element works well on various screen sizes"
      - "No horizontal scrolling on standard viewports"
      - "Spacing feels balanced and intentional"

  # ==========================================================================
  # Style & Visual - Visual Regression Baseline
  # ==========================================================================
  - id: "slider-svelte/default/style-visual-regression"
    sampleId: "default"
    severity: "warn"

    intent: "Creates visual regression baseline for gather mode"

    notes:
      - "Captures screenshot for future comparisons"
      - "Helps detect unintended visual changes"
      - "Run with UPDATE_SNAPSHOTS=true to create baseline"

    steps:
      - action: navigate
        path: "/slider"

      - action: screenshot
        target:
          description: "Slider element in gather mode"
          hint: '.pie-slider'
        name: "slider-svelte-default-gather"

    spiritChecks:
      - "Element renders consistently across browsers"
      - "No unexpected layout shifts or visual glitches"
