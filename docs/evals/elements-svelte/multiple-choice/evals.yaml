version: 1

component:
  element: "@pie-element/multiple-choice"
  framework: "svelte"

examplesApp:
  app: "@pie-element/multiple-choice"
  routeTemplate: "/docs/demo/demo.html"

evals:
  # ==========================================================================
  # Basic Rendering
  # ==========================================================================
  - id: "mc-svelte/simple-choice/renders-gather"
    sampleId: "simple-choice"
    severity: "error"

    intent: "Validates element renders correctly in gather mode"

    notes:
      - "Should display prompt and all choices"
      - "Radio buttons for single selection"
      - "Letter prefixes (A, B, C, D)"

    steps:
      - action: navigate
        path: "/docs/demo/demo.html"

      - action: observe
        target:
          description: "Prompt text"
          hint: 'text="What is 2 + 2?"'
        expected:
          exists: true

      - action: observe
        target:
          description: "Choice inputs"
          hint: 'input[type="radio"]'
        expected:
          exists: true

      - action: axe
        expected:
          maxViolations: 0
          wcagLevel: "AA"

    spiritChecks:
      - "Prompt displays clearly and is easy to read"
      - "Choices are well-spaced and easy to click"
      - "Visual design is clean and professional"

  # ==========================================================================
  # User Interactions - Correct Answer
  # ==========================================================================
  - id: "mc-svelte/simple-choice/correct-answer"
    sampleId: "simple-choice"
    severity: "error"

    intent: "Validates correct answer selection yields score of 1.0"

    notes:
      - "Choice B (value='b', label='4') is correct"
      - "Should update session state immediately"
      - "Evaluate mode should show correct feedback"

    steps:
      - action: navigate
        path: "/docs/demo/demo.html"

      - action: click
        target:
          description: "Correct choice (4)"
          hint: 'input[type="radio"][value="b"]'

      - action: observe
        target:
          description: "Session display"
          hint: 'pre code'
        expected:
          contains: '"b"'

      - action: click
        target:
          description: "Evaluate mode radio"
          hint: 'input[name="mode"][value="evaluate"]'

      - action: wait
        timeout: 1000

      - action: observe
        target:
          description: "Element container after evaluate"
          hint: '.bg-base-100'
        expected:
          exists: true

    expected:
      session:
        value:
          contains: "b"

  # ==========================================================================
  # User Interactions - Incorrect Answer
  # ==========================================================================
  - id: "mc-svelte/simple-choice/incorrect-answer"
    sampleId: "simple-choice"
    severity: "error"

    intent: "Validates incorrect answer yields score of 0.0"

    steps:
      - action: navigate
        path: "/docs/demo/demo.html"

      - action: click
        target:
          description: "Incorrect choice (3)"
          hint: 'input[type="radio"][value="a"]'

      - action: click
        target:
          description: "Evaluate mode"
          hint: 'input[name="mode"][value="evaluate"]'

      - action: wait
        timeout: 1000

    expected:
      session:
        value:
          contains: "a"

  # ==========================================================================
  # Multiple Selection Mode
  # ==========================================================================
  - id: "mc-svelte/multi-select/checkbox-mode"
    sampleId: "multi-select"
    severity: "error"

    intent: "Validates checkbox mode allows multiple selections"

    notes:
      - "Uses checkboxes instead of radio buttons"
      - "Correct answers: 2, 3, 5 (all prime numbers)"
      - "Should support partial credit scoring"

    steps:
      - action: navigate
        path: "/docs/demo/demo.html"

      - action: observe
        target:
          description: "Checkbox inputs"
          hint: 'input[type="checkbox"]'
        expected:
          exists: true

      - action: click
        target:
          description: "Choice A (2 - prime)"
          hint: 'input[type="checkbox"][value="a"]'

      - action: click
        target:
          description: "Choice B (3 - prime)"
          hint: 'input[type="checkbox"][value="b"]'

      - action: click
        target:
          description: "Choice D (5 - prime)"
          hint: 'input[type="checkbox"][value="d"]'

    expected:
      session:
        value:
          exists: true

  # ==========================================================================
  # View Mode
  # ==========================================================================
  - id: "mc-svelte/simple-choice/view-mode"
    sampleId: "simple-choice"
    severity: "error"

    intent: "Validates view mode displays answer without allowing changes"

    notes:
      - "Should show selected answer"
      - "Inputs should be disabled"
      - "No interaction allowed"

    steps:
      - action: navigate
        path: "/docs/demo/demo.html"

      - action: click
        target:
          description: "Select choice B"
          hint: 'input[type="radio"][value="b"]'

      - action: click
        target:
          description: "View mode"
          hint: 'input[name="mode"][value="view"]'

      - action: wait
        timeout: 1000

      - action: observe
        target:
          description: "Element in view mode"
          hint: '.bg-base-100'
        expected:
          exists: true

  # ==========================================================================
  # Evaluate Mode with Feedback
  # ==========================================================================
  - id: "mc-svelte/with-feedback/evaluate-shows-feedback"
    sampleId: "with-feedback"
    severity: "error"

    intent: "Validates evaluate mode displays choice-level feedback"

    notes:
      - "Sample has feedbackEnabled: true"
      - "Each choice has specific feedback text"
      - "Correct choice should show positive feedback"

    steps:
      - action: navigate
        path: "/docs/demo/demo.html"

      - action: click
        target:
          description: "Correct choice (Paris)"
          hint: 'input[type="radio"][value="b"]'

      - action: click
        target:
          description: "Evaluate mode"
          hint: 'input[name="mode"][value="evaluate"]'

      - action: wait
        timeout: 1000

      - action: observe
        target:
          description: "Element container"
          hint: '.bg-base-100'
        expected:
          exists: true

  # ==========================================================================
  # Instructor Role - Rationale Display
  # ==========================================================================
  - id: "mc-svelte/with-feedback/instructor-rationale"
    sampleId: "with-feedback"
    severity: "error"

    intent: "Validates instructor role displays rationale in evaluate mode"

    notes:
      - "Sample has rationaleEnabled: true"
      - "Rationale should only show for instructor role"
      - "Student role should not see rationale"

    steps:
      - action: navigate
        path: "/docs/demo/demo.html"

      - action: click
        target:
          description: "Select any answer"
          hint: 'input[type="radio"][value="b"]'

      - action: click
        target:
          description: "Evaluate mode"
          hint: 'input[name="mode"][value="evaluate"]'

      - action: click
        target:
          description: "Instructor role"
          hint: 'input[name="role"][value="instructor"]'

      - action: wait
        timeout: 1000

      - action: observe
        target:
          description: "Element container"
          hint: '.bg-base-100'
        expected:
          exists: true

  # ==========================================================================
  # Configuration - Grid Layout
  # ==========================================================================
  - id: "mc-svelte/grid-layout/layout-applies"
    sampleId: "grid-layout"
    severity: "error"

    intent: "Validates grid layout configuration applies correctly"

    notes:
      - "Sample uses choicesLayout: 'grid'"
      - "Choices should display in grid format"
      - "Should be responsive"

    steps:
      - action: navigate
        path: "/docs/demo/demo.html"

      - action: observe
        target:
          description: "Element container"
          hint: '.bg-base-100'
        expected:
          exists: true

      - action: axe
        expected:
          maxViolations: 0
          wcagLevel: "AA"

  # ==========================================================================
  # Configuration - Number Prefixes
  # ==========================================================================
  - id: "mc-svelte/grid-layout/number-prefixes"
    sampleId: "grid-layout"
    severity: "error"

    intent: "Validates number prefix configuration (1, 2, 3, 4)"

    notes:
      - "Sample uses choicePrefix: 'numbers'"
      - "Should show 1, 2, 3, 4 instead of A, B, C, D"

    steps:
      - action: navigate
        path: "/docs/demo/demo.html"

      - action: observe
        target:
          description: "Element with choices"
          hint: '.bg-base-100'
        expected:
          exists: true

  # ==========================================================================
  # Accessibility - Keyboard Navigation
  # ==========================================================================
  - id: "mc-svelte/simple-choice/keyboard-navigation"
    sampleId: "simple-choice"
    severity: "error"

    intent: "Validates full keyboard navigation support"

    notes:
      - "Must be navigable with Tab key"
      - "Radio buttons activatable with Space/Enter"
      - "Focus indicators must be visible"
      - "Tab order should be logical"

    steps:
      - action: navigate
        path: "/docs/demo/demo.html"

      - action: observe
        target:
          description: "Radio inputs"
          hint: 'input[type="radio"]'
        expected:
          exists: true

      - action: axe
        expected:
          maxViolations: 0
          wcagLevel: "AA"

    spiritChecks:
      - "Tab order follows visual layout"
      - "Focus indicators clearly visible"
      - "No keyboard traps"
      - "All interactive elements reachable"

  # ==========================================================================
  # Accessibility - Touch Target Size
  # ==========================================================================
  - id: "mc-svelte/simple-choice/touch-targets"
    sampleId: "simple-choice"
    severity: "error"

    intent: "Validates touch targets meet WCAG 2.2 requirements (44x44px)"

    notes:
      - "Radio buttons must be at least 44x44px"
      - "Or have adequate spacing between targets"
      - "WCAG 2.2 Level AA Target Size criterion"

    steps:
      - action: navigate
        path: "/docs/demo/demo.html"

      - action: axe
        expected:
          maxViolations: 0
          wcagLevel: "AA"

  # ==========================================================================
  # Error Handling - Empty Submission
  # ==========================================================================
  - id: "mc-svelte/simple-choice/empty-submission"
    sampleId: "simple-choice"
    severity: "error"

    intent: "Validates graceful handling when no choice selected"

    notes:
      - "User switches to evaluate mode without selecting anything"
      - "Should handle empty session gracefully"
      - "No JavaScript errors"

    steps:
      - action: navigate
        path: "/docs/demo/demo.html"

      - action: click
        target:
          description: "Evaluate mode (no selection)"
          hint: 'input[name="mode"][value="evaluate"]'

      - action: wait
        timeout: 1000

      - action: observe
        target:
          description: "Element renders without error"
          hint: '.bg-base-100'
        expected:
          exists: true

    expected:
      session:
        value:
          exists: true

  # ==========================================================================
  # State Management - Mode Switching
  # ==========================================================================
  - id: "mc-svelte/simple-choice/mode-switching"
    sampleId: "simple-choice"
    severity: "error"

    intent: "Validates smooth transitions between modes"

    notes:
      - "Should switch between gather, view, evaluate modes"
      - "Session state should persist"
      - "No visual glitches or errors"

    steps:
      - action: navigate
        path: "/docs/demo/demo.html"

      - action: click
        target:
          description: "Select choice"
          hint: 'input[type="radio"][value="b"]'

      - action: click
        target:
          description: "View mode"
          hint: 'input[name="mode"][value="view"]'

      - action: wait
        timeout: 500

      - action: click
        target:
          description: "Evaluate mode"
          hint: 'input[name="mode"][value="evaluate"]'

      - action: wait
        timeout: 500

      - action: click
        target:
          description: "Back to gather"
          hint: 'input[name="mode"][value="gather"]'

      - action: wait
        timeout: 500

      - action: observe
        target:
          description: "Element stable"
          hint: '.bg-base-100'
        expected:
          exists: true

  # ==========================================================================
  # State Management - Reset Functionality
  # ==========================================================================
  - id: "mc-svelte/simple-choice/reset"
    sampleId: "simple-choice"
    severity: "error"

    intent: "Validates reset button clears session and returns to initial state"

    steps:
      - action: navigate
        path: "/docs/demo/demo.html"

      - action: click
        target:
          description: "Select choice"
          hint: 'input[type="radio"][value="b"]'

      - action: click
        target:
          description: "Reset button"
          hint: 'button:has-text("Reset")'

      - action: wait
        timeout: 500

      - action: observe
        target:
          description: "Session cleared"
          hint: 'pre code'
        expected:
          contains: '[]'

  # ==========================================================================
  # Performance - Initial Load
  # ==========================================================================
  - id: "mc-svelte/simple-choice/load-performance"
    sampleId: "simple-choice"
    severity: "warn"

    intent: "Validates element loads and renders within acceptable time"

    notes:
      - "Target: < 2s to interactive"
      - "Measured from navigation to visible element"

    steps:
      - action: navigate
        path: "/docs/demo/demo.html"

      - action: wait
        condition: "networkidle"

      - action: observe
        target:
          description: "Element rendered"
          hint: '.bg-base-100'
        expected:
          exists: true

  # ==========================================================================
  # Multiple Attempts - Selection Changes
  # ==========================================================================
  - id: "mc-svelte/simple-choice/change-selection"
    sampleId: "simple-choice"
    severity: "error"

    intent: "Validates user can change selection before submitting"

    notes:
      - "Should allow clicking different choices"
      - "Session should update to latest selection"
      - "Previous selection should be deselected"

    steps:
      - action: navigate
        path: "/docs/demo/demo.html"

      - action: click
        target:
          description: "First choice"
          hint: 'input[type="radio"][value="a"]'

      - action: wait
        timeout: 200

      - action: click
        target:
          description: "Second choice"
          hint: 'input[type="radio"][value="b"]'

      - action: wait
        timeout: 200

      - action: observe
        target:
          description: "Session updated"
          hint: 'pre code'
        expected:
          contains: '"b"'

  # ==========================================================================
  # Style & Visual - Touch Target Sizes
  # ==========================================================================
  - id: "mc-svelte/simple-choice/style-touch-targets"
    sampleId: "simple-choice"
    severity: "error"

    intent: "Validates touch target sizes meet WCAG 2.2 Level AA requirements"

    notes:
      - "WCAG 2.2: Touch targets must be at least 44x44px"
      - "Or have adequate spacing from other targets"
      - "Critical for mobile accessibility"

    steps:
      - action: navigate
        path: "/docs/demo/demo.html"

      - action: checkStyle
        target:
          description: "Radio button input"
          hint: 'input[type="radio"]'
        property: "width"
        expected:
          greaterThanOrEqual: 20

      - action: checkStyle
        target:
          description: "Radio button input"
          hint: 'input[type="radio"]'
        property: "height"
        expected:
          greaterThanOrEqual: 20

    spiritChecks:
      - "Radio buttons are easy to tap on mobile devices"
      - "Adequate spacing between interactive elements"

  # ==========================================================================
  # Style & Visual - Color Contrast
  # ==========================================================================
  - id: "mc-svelte/simple-choice/style-color-contrast"
    sampleId: "simple-choice"
    severity: "error"

    intent: "Validates text color contrast meets WCAG 2.2 Level AA standards"

    notes:
      - "WCAG 2.2 AA: Normal text requires 4.5:1 contrast ratio"
      - "Large text (18pt+) requires 3:1 contrast ratio"
      - "Critical for users with visual impairments"

    steps:
      - action: navigate
        path: "/docs/demo/demo.html"

      - action: checkColorContrast
        target:
          description: "Prompt text"
          hint: 'text="What is 2 + 2?"'
        expected:
          ratio:
            greaterThanOrEqual: 4.5

      - action: checkColorContrast
        target:
          description: "Choice label text"
          hint: 'label >> text="4"'
        expected:
          ratio:
            greaterThanOrEqual: 4.5

    spiritChecks:
      - "Text is easily readable on all backgrounds"
      - "No reliance on color alone to convey information"

  # ==========================================================================
  # Style & Visual - Typography
  # ==========================================================================
  - id: "mc-svelte/simple-choice/style-typography"
    sampleId: "simple-choice"
    severity: "warn"

    intent: "Validates typography meets readability best practices"

    notes:
      - "Font size should be at least 16px for body text"
      - "Line height should be at least 1.5 for readability"
      - "Font families should use system font stacks"

    steps:
      - action: navigate
        path: "/docs/demo/demo.html"

      - action: checkFont
        target:
          description: "Prompt text"
          hint: 'text="What is 2 + 2?"'
        expected:
          fontSize:
            greaterThanOrEqual: 14
          lineHeight:
            greaterThanOrEqual: 1.2

    spiritChecks:
      - "Text is comfortable to read for extended periods"
      - "Typography hierarchy guides the eye appropriately"

  # ==========================================================================
  # Style & Visual - Layout Responsiveness
  # ==========================================================================
  - id: "mc-svelte/simple-choice/style-layout"
    sampleId: "simple-choice"
    severity: "warn"

    intent: "Validates element layout is responsive and well-structured"

    notes:
      - "Element should have reasonable min/max widths"
      - "Spacing should be consistent"
      - "Content should reflow properly"

    steps:
      - action: navigate
        path: "/docs/demo/demo.html"

      - action: checkLayout
        target:
          description: "Element container"
          hint: '.bg-base-100'
        expected:
          boundingBox:
            minWidth: 200

    spiritChecks:
      - "Element works well on various screen sizes"
      - "No horizontal scrolling on standard viewports"
      - "Spacing feels balanced and intentional"

  # ==========================================================================
  # Style & Visual - Visual Regression Baseline
  # ==========================================================================
  - id: "mc-svelte/simple-choice/style-visual-regression"
    sampleId: "simple-choice"
    severity: "warn"

    intent: "Creates visual regression baseline for gather mode"

    notes:
      - "Captures screenshot for future comparisons"
      - "Helps detect unintended visual changes"
      - "Run with UPDATE_SNAPSHOTS=true to create baseline"

    steps:
      - action: navigate
        path: "/docs/demo/demo.html"

      - action: screenshot
        target:
          description: "Multiple choice element in gather mode"
          hint: '.bg-base-100'
        name: "mc-svelte-simple-choice-gather"

    spiritChecks:
      - "Element renders consistently across browsers"
      - "No unexpected layout shifts or visual glitches"
