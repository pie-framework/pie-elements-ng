<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Standalone Hotspot Test</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      margin: 20px;
      font-family: system-ui, sans-serif;
      background: white;
    }
    h1 {
      font-size: 1.2rem;
      margin-bottom: 1rem;
    }
  </style>
</head>
<body>
  <h1>Standalone Hotspot Test (No Dev Server UI)</h1>
  <p>Rendering pie-hotspot with no container styling whatsoever:</p>
  <br>

  <pie-hotspot id="test"></pie-hotspot>

  <script type="module">
    // Use absolute URLs to the built files
    const base = 'http://localhost:5174';

    // Import element
    const ElementModule = await import(`${base}/packages/elements-react/hotspot/dist/index.js`);
    const Element = ElementModule.default;

    // Import controller
    let controller;
    try {
      const controllerModule = await import(`${base}/packages/elements-react/hotspot/dist/controller/index.js`);
      controller = controllerModule;
    } catch (e) {
      console.warn('Controller not available:', e);
    }

    // Define custom element
    if (!customElements.get('pie-hotspot')) {
      customElements.define('pie-hotspot', Element);
    }

    // Simple test model and session
    const model = {
      "element": "pie-hotspot",
      "id": "1",
      "dimensions": {
        "width": 600,
        "height": 400
      },
      "imageUrl": "https://upload.wikimedia.org/wikipedia/commons/thumb/1/1a/Blank_US_Map.svg/600px-Blank_US_Map.svg.png",
      "shapes": {
        "rectangles": [
          {
            "id": "rect1",
            "x": 100,
            "y": 100,
            "width": 100,
            "height": 80,
            "correct": true
          }
        ],
        "circles": [
          {
            "id": "circle1",
            "x": 300,
            "y": 200,
            "radius": 40,
            "correct": false
          }
        ],
        "polygons": []
      },
      "hotspotColor": "rgba(137, 183, 244, 0.65)",
      "outlineColor": "blue",
      "strokeWidth": 4,
      "multipleCorrect": true,
      "mode": "gather",
      "disabled": false
    };

    const session = {
      "id": "1",
      "element": "pie-hotspot",
      "answers": []
    };

    // Process model
    let processedModel = model;
    if (controller?.model) {
      const env = { mode: 'gather', role: 'student' };
      processedModel = await controller.model(model, session, env);
      console.log('Processed model:', processedModel);
    }

    // Get element and set properties
    const element = document.getElementById('test');
    element.model = processedModel;
    element.session = session;

    console.log('Hotspot initialized');
  </script>
</body>
</html>
